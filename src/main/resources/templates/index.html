<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

  <head th:replace="~{common/head::common-head}"/>

  <body class="hold-transition skin-blue fixed sidebar-mini">
    <!-- Site wrapper -->
    <div class="wrapper">
		<header th:replace="~{common/top::common-top}"/>

		<aside th:replace="~{common/left::common-left}"/>


	<!-- Content Wrapper. Contains page content -->
	<div class="content-wrapper">
		<!-- Content Header (Page header) -->
		<section class="content-header">
			<h1>
				Fixed Layout
				<small>Blank example to the fixed layout</small>
			</h1>
			<ol class="breadcrumb">
				<li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
				<li><a href="#">Layout</a></li>
				<li class="active">Fixed</li>
			</ol>
		</section>

		<!-- Main content -->
		<section class="content">
			<!-- Default box -->
			<div class="box">
				<div class="box-header with-border">
					<h3 class="box-title">
						<button type="button" id="save_glasses_btn" class="btn btn-block btn-success btn-flat">保存</button>
					</h3>

					<div class="box-tools pull-right">
						<button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="Collapse">
							<i class="fa fa-minus"></i></button>
						<button type="button" class="btn btn-box-tool" data-widget="remove" data-toggle="tooltip" title="Remove">
							<i class="fa fa-times"></i></button>
					</div>
				</div>
				<div class="box-body">

					<div class="container-fluid">
						<!--左右-->
						<div class="row">
							<!--左边零件-->
							<div class="col-sm-3" style="height: 400px;" id="widget">
								<img th:src="@{/static/img/script.png}" alt="" />
								<img th:src="@{/static/img/script.png}" alt="" />
								<img th:src="@{/static/img/script.png}" alt="" />
								<img th:src="@{/static/img/script.png}" alt="" />
								<img th:src="@{/static/img/script.png}" alt="" />
							</div>
							<!--右边-->
							<div id="container" class="col-sm-9" th:style="'position: relative;height: 400px;background:url(' + @{/static/img/grid.png} + ');'">
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- /.box -->
		</section>
		<!-- /.content -->
	</div>
	<!-- /.content-wrapper -->

		<footer th:replace="~{common/footer::common-footer}"/>

		<aside th:replace="~{common/setting::common-setting}"/>
</div>
<!-- ./wrapper -->

<script type="text/javascript">
	$(function(){
		var $container = $("#container");
		//开始位置
		var _x,_y;
		var draging=false;
		var $it;
		var paddingLeft = 15;
		var paddingRight = $container.css('padding-right');

		$("#widget").on("click","img",function(){

			//点击了之后应该在右边出现对应的图标
			var $tempImg = $("<img/>");
			$tempImg.attr("src",$(this).attr("src"));
			$tempImg.css("position","absolute");

			//处理拖动事件
			$tempImg.on("mousedown",function(e){
				//开始移动
				draging = true;
				e = e || window.event;
				$it  = $(this);
				//pageX:事件触发时事件源在整个页面的X轴位置
				//pageY:事件触发时事件源在整个页面的Y轴位置

				_x = e.pageX - $it.position().left;

				_y = e.pageY - $it.position().top;

				return false;
			});

			$(document).on("mousemove",function(e){
				if (!draging) {
					return false;
				}
				e = e || window.event;
				var x = e.pageX - _x;
				var y = e.pageY - _y;
				var maxL = $container.width()- $it.outerWidth(true);
				var maxT = $container.height() - $it.outerHeight(true);
				x = x < 0 ? paddingLeft : x;
				x = x > maxL ? maxL : x;
				y = y < 0 ? 0 : y;
				y = y > maxT ? maxT : y;
				$it.css({ left: x, top: y });
			}).on("mouseup",function(e){
				draging = false;
				return false;
			});
			$container.append($tempImg);
		});

		$("#save_glasses_btn").on("click",function(){
			//获取每个部件的信息，并且提示结构信息
			var paramInfos = [];
			var widgetInfos =  $container.find("img");
			$.each(widgetInfos,function(index,item){
				//type
				//item
				//数量
				//info
				//x
				//y
				item = $(item);<!--左边零件-->
				var paramInfo={};
				paramInfo.x = item.position().left;
				paramInfo.y = item.position().top;
				paramInfos[index] = paramInfo;
			});

			//异步提交

			//弹出提示


		});
	});
</script>


</body>
</html>